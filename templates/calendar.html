<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fencing Hub - Events Calendar</title>
    <link rel="stylesheet" href="/Static/styles.css">
    <link rel="icon" type="image/png" href="Static/Images/Logos/Logo.png">
</head>
<body id="rankings-page" style="background: url('Static/Images/Background.jpg') no-repeat center; background-size: cover;">
    {% block content %}
    <nav class="navbar">
        <img src="Static/Images/Logos/Logo_removed.png" alt="Logo" class="logo-img">
        <ul class="menu">
            <li><a href="/home">Home</a></li>
            <li><a href="/rankings">Rankings</a></li>
            <li class="dropdown">
                <a href="/events">Events â–¼</a>
                <div class="dropdown-content">
                    <a href="/calendar">Calendar</a>
                    <a href="#">Results</a>
                </div>
            </li>
            <li class="dropdown">
                <a href="#">Information â–¼</a>
                <div class="dropdown-content">
                    <a href="/about_fencing">About Fencing</a>
                    <a href="/fencing_stories.html">Stories</a>
                    <a href="/about_us.html">About Us</a>
                </div>
            </li>
        </ul>
        <div class="btns">
            <button onclick="window.location.href='/login'">ðŸ‘¤Log In</button>
        </div>
    </nav>
    <main class="container">
        <h1>Events Calendar</h1>
        <div class="selectors">
            <div class="selector-group">
                <label for="month" class="selector-label">Select Month:</label>
                <select id="month">
                    <option value="0">January</option>
                    <option value="1">February</option>
                    <option value="2">March</option>
                    <option value="3">April</option>
                    <option value="4">May</option>
                    <option value="5">June</option>
                    <option value="6">July</option>
                    <option value="7">August</option>
                    <option value="8">September</option>
                    <option value="9">October</option>
                    <option value="10">November</option>
                    <option value="11">December</option>
                </select>
            </div>
            <div class="vertical-line"></div>
            <div class="selector-group">
                <label for="year" class="selector-label">Select Year:</label>
                <select id="year">
                    <option value="2023">2023</option>
                    <option value="2024">2024</option>
                    <option value="2025">2025</option>
                </select>
            </div>
        </div>
        <table id="calendar">
            <thead>
                <tr>
                    <th>Sunday</th>
                    <th>Monday</th>
                    <th>Tuesday</th>
                    <th>Wednesday</th>
                    <th>Thursday</th>
                    <th>Friday</th>
                    <th>Saturday</th>
                </tr>
            </thead>
            <tbody>
                <!-- Calendar days will be generated dynamically using JavaScript -->
            </tbody>
        </table>
        <div id="event-list" style="display: flex; justify-content: space-between;">
            <div id="upcoming-events" style="width: 48%;">
                <h2>Upcoming Events</h2>
                <ul id="events">
                    {% for event in events %}
                    <li data-date="{{ event[2] }}">{{ event[1] }}</li>
                    {% endfor %}
                </ul>
            </div>
            <div id="events-in-month" style="width: 48%;">
                <h2>Events in Month</h2>
                <ul id="filtered-events">
                </ul>
            </div>
        </div>
    </main>
    <footer>
        <p>&copy; 2024 Fencing Hub. All rights reserved.</p>
        <div class="social-media">
            <a href="#"><img src="Static/Images/Logos/Facebook.png" alt="Facebook"></a>
            <a href="#"><img src="Static/Images/Logos/X.png" alt="Twitter"></a>
            <a href="#"><img src="Static/Images/Logos/Insta.png" alt="Instagram"></a>
        </div>
    </footer>
    
    <!-- JavaScript for Dynamic Calendar and Event List -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const monthSelect = document.getElementById('month');
            const yearSelect = document.getElementById('year');
            const calendarBody = document.querySelector('#calendar tbody');
            const filteredEventList = document.getElementById('filtered-events');
            const upcomingEventList = document.getElementById('events');
            const eventSection = document.getElementById('event-list');

            const renderCalendar = (month, year) => {
                calendarBody.innerHTML = ''; // Clear the current calendar

                const firstDay = new Date(year, month).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();

                let row = document.createElement('tr');
                for (let i = 0; i < firstDay; i++) {
                    let cell = document.createElement('td');
                    row.appendChild(cell);
                }

                for (let day = 1; day <= daysInMonth; day++) {
                    if (row.children.length === 7) {
                        calendarBody.appendChild(row);
                        row = document.createElement('tr');
                    }
                    let cell = document.createElement('td');
                    cell.textContent = day;
                    row.appendChild(cell);
                }

                calendarBody.appendChild(row);
            };

            const renderEvents = (month, year) => {
                filteredEventList.innerHTML = ''; // Clear previous event list

                const eventsItems = upcomingEventList.querySelectorAll('li');
                let eventsFound = false; // Flag to check if any events are found

                eventsItems.forEach(event => {
                    const eventDate = new Date(event.getAttribute('data-date'));
                    if (eventDate.getMonth() === month && eventDate.getFullYear() === year) {
                        const li = document.createElement('li');
                        li.textContent = `${eventDate.getDate()} ${monthSelect.options[month].text} ${year} - ${event.textContent}`;
                        filteredEventList.appendChild(li);
                        eventsFound = true;
                    }
                });

                // Show or hide the event section based on whether events are found
                document.getElementById('events-in-month').style.display = eventsFound ? 'block' : 'none';
            };

            const updateCalendarAndEvents = () => {
                const selectedMonth = parseInt(monthSelect.value);
                const selectedYear = parseInt(yearSelect.value);
                renderCalendar(selectedMonth, selectedYear);
                renderEvents(selectedMonth, selectedYear);
            };

            monthSelect.addEventListener('change', updateCalendarAndEvents);
            yearSelect.addEventListener('change', updateCalendarAndEvents);

            const today = new Date();
            monthSelect.value = today.getMonth();
            yearSelect.value = today.getFullYear();
            renderCalendar(today.getMonth(), today.getFullYear());
            renderEvents(today.getMonth(), today.getFullYear());
        });
    </script>
    {% endblock %}
</body>
</html>
